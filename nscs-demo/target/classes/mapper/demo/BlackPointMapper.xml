<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.inspur.nscs.demo.dao.BlackPointDao">
	<resultMap id="BaseResultMap" type="com.inspur.nscs.demo.domain.BlackPointDO">
		<id column="id" property="id" />
		<result column="geom" property="geom" />
		<result column="city" property="city" />
		<result column="district" property="district" />
		<result column="scene_type" property="sceneType" />
		<result column="name" property="name" />
		<result column="lon" property="lon" />
		<result column="lat" property="lat" />
		<result column="scene_id" property="sceneId" />
		<result column="shapge_leng" property="shapeLeng" />
		<result column="shape_area" property="shapeArea" />
	</resultMap>

	<sql id="Base_Column_List">
    	geom,
    	city,
    	district,
    	scene_type,
    	name,
    	lon,
    	lat,
    	scene_id,
    	shape_leng,
    	shape_area
    </sql>
	<!--<insert id="insertCustomArea"  useGeneratedKeys="true" keyProperty="id">
		insert into custom_area_save
		(   name,
			area,
			length,
			field1,
			field2,
			remark,
			create_user,
			create_time,
			wkt,
			geom
		)

		values
		(
			#{name},
			cast(#{area} as numeric),
			cast(#{length} as numeric),
			#{field1},
			#{field2},
			#{remark},
			#{createUser},
			#{createTime}::timestamp ,
			#{wkt},
			ST_GeomFromEWKT(#{wkt})
		)
	</insert>-->

	<select id="list" resultType="com.inspur.nscs.demo.domain.BlackPointDO">
		select id,geom,city,district,scene_type,name,lon,lat,scene_id,shape_leng,shape_area from blackpoint where 1=1
		<if test="city != null and city != ''">
		    and city = #{city}
        </if>
        <if test="district != null and district != ''">
            and district like '%${district}%'
        </if>
        <if test="sceneType != null and sceneType != ''">
            and scene_type = #{sceneType}
        </if>
        <if test="name != null and name != ''">
            and name like '%${name}%'
        </if>
		<if test="offset != null and limit != null">
            limit #{limit} offset #{offset}
		</if>

	</select>

	<select id="count" resultType="int">
		select count(1) from blackpoint where 1=1
		<if test="city != null and city != ''">
		    and city = #{city}
        </if>
        <if test="district != null and district != ''">
            and district like '%${district}%'
        </if>
        <if test="sceneType != null and sceneType != ''">
            and scene_type = #{sceneType}
        </if>
        <if test="name != null and name != ''">
            and name like '%${name}%'
        </if>
	</select>

	<!--<update id="updateCustomArea">
	    update custom_area_save
	    <set>
			<if test="name != null">name = #{name}, </if>
			<if test="area != null">area = cast(#{area} as numeric),</if>
			<if test="length != null">length = cast(#{length} as numeric),</if>
			<if test="field1 != null">field1 = #{field1},</if>
			<if test="field2 != null">field2 = #{field2},</if>
			<if test="remark != null">remark = #{remark},</if>
			<if test="create_user != null">create_user = #{createUser},</if>
			<if test="wkt != null">wkt = #{wkt},</if>
			<if test="wkt != null">geom = ST_GeomFromEWKT(#{wkt}),</if>
			<if test="updateTime != null">update_time = #{updateTime}::timestamp,</if>
			<if test="createTime != null">create_time = #{createTime}::timestamp</if>
		</set>
		where id = #{id}
    </update>
    <select id="getOid" resultType="java.lang.Long">
    select t.org_id from sso_auth.AUTH_ORG t ,sso_auth.AUTH_USER u where t.ORG_ID = u.ORG_ID and u.USER_ID=#{userid}

    </select>

    <select id="getAuthUsers" resultType="com.inspur.nscs.demo.domain.AuthUserDo">
    select u.* from sso_auth.AUTH_ORG t ,sso_auth.AUTH_USER u where t.ORG_ID = u.ORG_ID and u.USER_ID=#{userid}
</select>-->

</mapper>
